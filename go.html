<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Redirecionando...</title>
  <script>
    // ===== LINKS =====
    const DESTINO = "https://chat.whatsapp.com/LkOqxXxsk3p8BgJtH0ovfk?mode=ac_t"; // oficial
    const OPCIONAL = "https://amorim112.github.io/CupomSopee/LinkOfertasCupons.html"; // opcional
    // =================

    // Lê parâmetros ?cat=...&ref=...
    const params = new URLSearchParams(window.location.search);
    const cat = params.get("cat");
    const ref = params.get("ref");

    // Monta URL de destino
    function montarUrl(base) {
      const url = new URL(base);
      if (cat) url.searchParams.set("utm_source", cat);
      if (ref) url.searchParams.set("utm_content", ref);
      return url.toString();
    }

    const urlOficial = montarUrl(DESTINO);
    const urlOpcional = montarUrl(OPCIONAL);

    // Testa se o oficial responde antes de redirecionar
    fetch(urlOficial, { method: "HEAD", mode: "no-cors" })
      .then(() => {
        // Se não deu erro → redireciona oficial
        window.location.replace(urlOficial);
      })
      .catch(() => {
        // Se falhou → redireciona opcional
        window.location.replace(urlOpcional);
      });
  </script>
</head>
<body>
  <p>Redirecionando... Se não funcionar, <a id="fallback" href="#">clique aqui</a>.</p>
  <script>
    // Fallback manual já aponta para o opcional
    document.getElementById("fallback").href = (function () {
      const url = new URL("https://s.shopee.com.br/60Fxu2TlG0");
      if (cat) url.searchParams.set("utm_source", cat);
      if (ref) url.searchParams.set("utm_content", ref);
      return url.toString();
    })();
  </script>
</body>
</html>
